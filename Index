query("select * from webuser"); $fname=$_SESSION['personal']['fname']; $lname=$_SESSION['personal']['lname']; $name=$fname." ".$lname; $address=$_SESSION['personal']['address']; $nic=$_SESSION['personal']['nic']; $dob=$_SESSION['personal']['dob']; $email=$_POST['newemail']; $tele=$_POST['tele']; $newpassword=$_POST['newpassword']; $cpassword=$_POST['cpassword']; if ($newpassword==$cpassword){ $sqlmain= "select * from webuser where email=?;"; $stmt = $database->prepare($sqlmain); $stmt->bind_param("s",$email); $stmt->execute(); $result = $stmt->get_result(); if($result->num_rows==1){ $error='Already have an account for this Email address.'; }else{ //TODO $database->query("insert into patient(pemail,pname,ppassword, paddress, pnic,pdob,ptel) values('$email','$name','$newpassword','$address','$nic','$dob','$tele');"); $database->query("insert into webuser values('$email','p')"); //print_r("insert into patient values($pid,'$email','$fname','$lname','$newpassword','$address','$nic','$dob','$tele');"); $_SESSION["user"]=$email; $_SESSION["usertype"]="p"; $_SESSION["username"]=$fname; header('Location: patient/index.php'); $error=''; } }else{ $error='Password Confirmation Error! Reconfirm Password'; } }else{ //header('location: signup.php'); $error=''; } ?>
Let's Get Started
